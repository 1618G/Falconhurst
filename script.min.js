function initScrollProgress(){const e=document.getElementById("scrollProgress");if(!e)return;let t=document.documentElement.scrollHeight-window.innerHeight;function n(){const n=t>0?window.pageYOffset/t*100:0;e.style.width=n+"%"}window.addEventListener("scroll",n,{passive:!0}),window.addEventListener("resize",()=>{t=document.documentElement.scrollHeight-window.innerHeight}),n()}function cacheSectionOffsets(e){return Array.from(e).map(e=>({id:e.getAttribute("id"),top:e.offsetTop}))}function updateActiveNav(e,t){const n=window.pageYOffset+window.innerHeight/3;let o="";for(let t=0;t<e.length;t++)e[t].top<=n&&(o=e[t].id);t.forEach(e=>{e.classList.remove("section-active");const t=e.getAttribute("href");t&&t==="#"+o&&e.classList.add("section-active")})}function initNavigation(){const e=document.getElementById("navbar"),t=document.getElementById("navToggle"),n=document.getElementById("navMenu"),o=document.querySelectorAll(".nav-link"),i=document.querySelectorAll("section[id], header[id]");let r=cacheSectionOffsets(i);window.addEventListener("resize",()=>{r=cacheSectionOffsets(i)}),window.addEventListener("scroll",throttle(()=>{window.pageYOffset>100?e.classList.add("scrolled"):e.classList.remove("scrolled"),updateActiveNav(r,o)},80),{passive:!0}),t.addEventListener("click",()=>{t.classList.toggle("active"),n.classList.toggle("active"),document.body.style.overflow=n.classList.contains("active")?"hidden":""}),o.forEach(e=>{e.addEventListener("click",()=>{t.classList.remove("active"),n.classList.remove("active"),document.body.style.overflow=""})}),document.addEventListener("click",e=>{n.contains(e.target)||t.contains(e.target)||(t.classList.remove("active"),n.classList.remove("active"),document.body.style.overflow="")})}function initHeroCarousel(){const e=document.querySelectorAll(".hero-slide");if(e.length<=1)return;let t=0;const n=e.length;setInterval(()=>{var o;t=(t+1)%n,o=t,e.forEach((e,t)=>{e.classList.toggle("active",t===o)})},6e3)}function initHeroParallax(){const e=document.querySelector(".hero"),t=document.querySelector(".hero-content");if(!e||!t)return;window.matchMedia("(prefers-reduced-motion: reduce)").matches||window.addEventListener("scroll",()=>{const n=window.pageYOffset,o=e.offsetHeight;if(n>o)return;const i=.35*n,r=1-n/o*.8;t.style.transform=`translateY(${i}px)`,t.style.opacity=Math.max(r,0)},{passive:!0})}function initGalleryCarousel(){const e=document.getElementById("galleryTrack"),t=document.getElementById("galleryPrev"),n=document.getElementById("galleryNext"),o=document.getElementById("galleryDots");if(!e)return;const i=e.querySelectorAll(".gallery-slide"),r=i.length;let s=0,c=l();function a(){o.innerHTML="";const e=Math.ceil(r/c);for(let t=0;t<e;t++){const e=document.createElement("button");e.className="gallery-dot"+(0===t?" active":""),e.setAttribute("aria-label",`Go to slide group ${t+1}`),e.addEventListener("click",()=>u(t*c)),o.appendChild(e)}}function l(){return window.innerWidth<768?1:window.innerWidth<1024?2:3}function d(){const t=i[0].offsetWidth+16,n=-s*t;e.style.transform=`translateX(${n}px)`;const r=o.querySelectorAll(".gallery-dot"),a=Math.floor(s/c);r.forEach((e,t)=>{e.classList.toggle("active",t===a)})}function u(e){const t=r-c;s=Math.max(0,Math.min(e,t)),d()}function f(){s<r-c?s++:s=0,d()}function m(){s>0?s--:s=r-c,d()}n.addEventListener("click",f),t.addEventListener("click",m);let v,g=0;e.addEventListener("touchstart",e=>{g=e.changedTouches[0].screenX},{passive:!0}),e.addEventListener("touchend",e=>{const t=g-e.changedTouches[0].screenX;Math.abs(t)>50&&(t>0?f():m())},{passive:!0}),window.addEventListener("resize",()=>{clearTimeout(v),v=setTimeout(()=>{c=l(),a(),u(0)},250)}),a()}function initScrollReveals(){const e=[];[{selector:".welcome-image",direction:"left"},{selector:".welcome-content",direction:"right"},{selector:".about-card",direction:"up",stagger:!0},{selector:".contact-info",direction:"left"},{selector:".contact-form-wrapper",direction:"right"},{selector:".section-header",direction:"up"},{selector:".story-content",direction:"scale"},{selector:".award-content",direction:"up"},{selector:".about-features-list",direction:"up"},{selector:".location-content",direction:"right"}].forEach(t=>{document.querySelectorAll(t.selector).forEach((n,o)=>{n.classList.add("reveal",`reveal-${t.direction}`),t.stagger&&n.classList.add("stagger-"+(o%6+1)),e.push(n)})});const t=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&(e.target.classList.add("visible"),t.unobserve(e.target))})},{threshold:.1,rootMargin:"0px 0px -60px 0px"});e.forEach(e=>t.observe(e))}function initSectionDividers(){const e=document.querySelectorAll(".section-divider"),t=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&(e.target.classList.add("animated"),t.unobserve(e.target))})},{threshold:.5});e.forEach(e=>t.observe(e))}function initRoomsListReveal(){const e=document.querySelector(".rooms-list");if(!e)return;const t=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&(e.target.classList.add("animated"),t.unobserve(e.target))})},{threshold:.2});t.observe(e)}function initStoryReveal(){const e=document.querySelectorAll(".story-content p");if(!e.length)return;const t=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&(e.target.classList.add("visible"),t.unobserve(e.target))})},{threshold:.3,rootMargin:"0px 0px -40px 0px"});e.forEach(e=>t.observe(e))}function initAwardQuoteReveal(){const e=document.querySelector(".award-quote");if(!e)return;const t=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&(e.target.classList.add("animated"),t.unobserve(e.target))})},{threshold:.3});t.observe(e)}function initReviewCardReveals(){const e=document.querySelectorAll(".review-card");if(!e.length)return;const t=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&(e.target.classList.add("visible"),t.unobserve(e.target))})},{threshold:.2,rootMargin:"0px 0px -40px 0px"});e.forEach((e,n)=>{e.style.transitionDelay=.12*n+"s",t.observe(e)})}function initButtonRipple(){document.querySelectorAll(".btn").forEach(e=>{e.addEventListener("mouseenter",t=>{const n=e.getBoundingClientRect(),o=(t.clientX-n.left)/n.width*100,i=(t.clientY-n.top)/n.height*100;e.style.setProperty("--ripple-x",o+"%"),e.style.setProperty("--ripple-y",i+"%")})})}function initContactForm(){const e=document.getElementById("contactForm");e&&e.addEventListener("submit",t=>{t.preventDefault();const n=new FormData(e),o=Object.fromEntries(n.entries());if(!o.email||(i=o.email,!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(i)))return void alert("Please enter a valid email address.");var i;const r=encodeURIComponent("Falconhurst Holiday Let Enquiry"),s=encodeURIComponent(`Hello,\n\nI would like to make an enquiry about staying at Falconhurst.\n\n--- Enquiry Details ---\n\nName: ${o.name||"Not provided"}\nEmail: ${o.email}\nNumber of Guests: ${o.guests||"Not specified"}\nPreferred Dates: ${o.dates||"Not specified"}\n\nMessage:\n${o.message||"No additional message"}\n\n---\n\nI look forward to hearing from you.\n\nKind regards`);window.location.href=`mailto:falconhurstbay@gmail.com?subject=${r}&body=${s}`})}function initSmoothScroll(){document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){const t=this.getAttribute("href");if("#"===t)return;const n=document.querySelector(t);if(!n)return;e.preventDefault();const o=document.getElementById("navbar").offsetHeight,i=n.getBoundingClientRect().top+window.pageYOffset-o-20;window.scrollTo({top:i,behavior:"smooth"})})})}function throttle(e,t){let n;return function(...o){n||(e.apply(this,o),n=!0,setTimeout(()=>n=!1,t))}}document.addEventListener("DOMContentLoaded",()=>{initScrollProgress(),initNavigation(),initHeroCarousel(),initHeroParallax(),initGalleryCarousel(),initScrollReveals(),initSectionDividers(),initRoomsListReveal(),initStoryReveal(),initAwardQuoteReveal(),initReviewCardReveals(),initContactForm(),initSmoothScroll(),initButtonRipple()});